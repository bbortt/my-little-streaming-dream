plugins {
    id 'base'
    id 'com.moowork.node' version '1.3.1'
}

group 'io.github.bbortt.qdrakeboo.federation'

clean {
    delete '.next'
    delete 'node_modules'
    delete 'out'
}

node {
    version = '12.13.0'
    download = true
}

task test(type: NpmTask, dependsOn: npmInstall) {
    args = ['run', 'coverage']
}

task bundle(type: NpmTask, dependsOn: test) {
    args = ['run', 'fullbuild']
}

task export(type: NpmTask, dependsOn: bundle) {
    args = ['run', 'export']
}

task flow(type: NpmTask, dependsOn: npmInstall) {
    args = ['run', 'flow']
}

task lint(type: NpmTask, dependsOn: flow) {
    args = ['run', 'prettier:check']
}

assemble.dependsOn export
check.dependsOn lint
